<artifact identifier="firebase-guestbook" type="text/html" title="Firebase ì—°ë™ ê±´ì˜ì‚¬í•­ í˜ì´ì§€ (ì™„ì„±)">
<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>ê±´ì˜ì‚¬í•­ Â· Firebase ì‹¤ì‹œê°„ ë™ê¸°í™”</title>
<style>
  :root{--bg:#ffffff;--card:#fff;--text:#0b1020;--muted:#606a7a;--accent:#1d4ed8;--border:#e5e7eb;--badge:#f1f5f9}
  *{box-sizing:border-box}
  html,body{margin:0;background:#ffffff;color:var(--text);font-family:ui-sans-serif,-apple-system,BlinkMacSystemFont,"Segoe UI",Roboto,"Noto Sans KR","Apple SD Gothic Neo","Malgun Gothic",Arial,"Helvetica Neue",sans-serif}
  .wrap{max-width:840px;margin:28px auto;padding:0 16px 40px}
  header{display:flex;gap:12px;align-items:center;justify-content:space-between;flex-wrap:wrap}
  h1{font-size:20px;margin:0}
  .muted{color:var(--muted);font-size:13px}
  .card{background:#ffffff;border:1px solid var(--border);border-radius:14px;padding:14px;box-shadow:0 1px 3px rgba(0,0,0,0.08)}
  .row{display:flex;gap:12px;flex-wrap:wrap}
  .input, textarea{width:100%;background:#fff;border:1px solid var(--border);border-radius:10px;padding:10px;color:var(--text);transition:all .2s}
  .input:focus, textarea:focus{outline:none;border-color:#1d4ed8;box-shadow:0 0 0 3px rgba(29,78,216,0.1)}
  textarea{min-height:96px;resize:vertical}
  .btn{display:inline-flex;align-items:center;gap:8px;border:1px solid var(--border);background:#fff;border-radius:10px;padding:10px 12px;font-weight:800;cursor:pointer;transition:all .2s}
  .btn:hover{transform:translateY(-1px);box-shadow:0 4px 12px rgba(29,78,216,0.15);border-color:#1d4ed8}
  .btn:disabled{opacity:.5;cursor:not-allowed;transform:none}
  .btn.primary{background:#1d4ed8;border-color:#1d4ed8;color:#fff}
  .btn.danger{border-color:#ef4444;color:#991b1b}
  .btn.sm{padding:6px 10px;font-weight:700;border-radius:8px}
  .toolbar{display:flex;gap:8px;flex-wrap:wrap;margin:10px 0}
  .who{display:flex;gap:8px;align-items:center;flex-wrap:wrap}
  .pill{display:inline-flex;align-items:center;gap:8px;border:1px dashed var(--border);background:var(--badge);border-radius:999px;padding:6px 10px;font-weight:800}
  .badge{display:inline-flex;align-items:center;gap:6px;background:var(--badge);border:1px dashed var(--border);padding:3px 8px;border-radius:999px;font-size:12px;font-weight:700}
  .list{display:grid;grid-template-columns:1fr;gap:12px;margin-top:14px}
  .post{position:relative;border:1px solid var(--border);border-radius:14px;padding:14px;background:#fff}
  .post .meta{display:flex;gap:8px;align-items:center;justify-content:space-between}
  .post .name{font-weight:800}
  .post .time{font-size:12px;color:var(--muted)}
  .post .msg{margin-top:8px;white-space:pre-wrap;word-break:break-word}
  .err{display:none;border:1px solid #b91c1c;background:#7f1d1d;color:#fff;padding:8px 10px;border-radius:8px;margin:12px 0;white-space:pre-wrap}
  footer{margin-top:20px;font-size:12px;color:var(--muted);text-align:center}
  .link{color:var(--accent);text-decoration:none;font-weight:700}
  .link:hover{text-decoration:underline}
  .toast {
    position: fixed; left: 50%; top: 20px; transform: translateX(-50%);
    background: #111827; color:#fff; padding:10px 14px; border-radius:10px;
    box-shadow: 0 6px 18px rgba(0,0,0,.2); z-index: 9999; opacity: 0;
    transition: opacity .25s, transform .25s;
    font-weight: 800; letter-spacing: .2px;
  }
  .toast.show {
    opacity: 1; transform: translateX(-50%) translateY(0);
  }
  .modal-backdrop{position:fixed;inset:0;background:rgba(0,0,0,.35);display:none;align-items:center;justify-content:center;z-index:9999}
  .modal{background:#fff;border:1px solid var(--border);border-radius:14px;max-width:360px;width:92%;padding:16px;box-shadow:0 10px 30px rgba(0,0,0,.2);animation:pop .15s ease-out}
  .modal h3{margin:0 0 8px;font-size:16px;font-weight:800}
  .modal p{margin:0 0 14px;color:var(--muted);white-space:pre-wrap}
  .modal .actions{display:flex;gap:8px;justify-content:flex-end}
  .modal .btn{padding:8px 12px;border-radius:10px;border:1px solid var(--border);background:#fff;font-weight:800;cursor:pointer}
  .modal .btn.primary{background:#1d4ed8;border-color:#1d4ed8;color:#fff}
  @keyframes pop{from{transform:translateY(6px);opacity:.0}to{transform:translateY(0);opacity:1}}
  .loading{text-align:center;padding:20px;color:var(--muted)}
</style>
</head>
<body>
<div class="wrap">
  <header>
    <div>
      <h1>ê±´ì˜ì‚¬í•­ ğŸ”¥ ì‹¤ì‹œê°„ ë™ê¸°í™”</h1>
      <div class="muted">ì‘ì„±ì ì„ íƒ â†’ ë¹„ë°€ë²ˆí˜¸ ì…ë ¥ í›„ ê¸€ ì‘ì„± ê°€ëŠ¥ (ê´€ë¦¬ì: ë°ì´í„° ê´€ë¦¬)</div>
    </div>
    <a class="link" href="./index.html">â† ë©”ì¸ìœ¼ë¡œ</a>
  </header>
  <div class="card" style="margin:12px 0;">
    <div class="who">
      <span class="badge">ì‘ì„±ì ì„ íƒ:</span>
      <button class="btn sm" data-user="ë‚˜ì˜">ë‚˜ì˜</button>
      <button class="btn sm" data-user="í˜„í˜¸ìŒ¤">í˜„í˜¸ìŒ¤</button>
      <button class="btn sm" data-user="í˜œë¹ˆìŒ¤">í˜œë¹ˆìŒ¤</button>
      <button class="btn sm" data-admin="true">ê´€ë¦¬ì</button>
      <span id="status" class="pill" style="margin-left:auto">ë¡œê·¸ì¸ ì•ˆ ë¨</span>
      <button id="logoutBtn" class="btn sm" style="display:none">ë¡œê·¸ì•„ì›ƒ</button>
    </div>
  </div>
  <div id="err" class="err"></div>
  <section class="card">
    <form id="form">
      <div class="row">
        <input class="input" id="name" maxlength="40" placeholder="í‘œì‹œ ì´ë¦„" disabled />
      </div>
      <div class="row">
        <textarea id="msg" maxlength="100" placeholder="ë©”ì‹œì§€ (ìµœëŒ€ 100ì, ì¤„ë°”ê¿ˆ ê°€ëŠ¥)" required disabled></textarea>
      </div>
      <div class="toolbar">
        <button type="submit" id="submitBtn" class="btn primary" disabled>ì‘ì„±í•˜ê¸°</button>
        <button type="button" id="exportBtn" class="btn" style="display:none">JSON ë‚´ë³´ë‚´ê¸°</button>
        <label id="importLabel" class="btn" style="display:none">
          JSON ê°€ì ¸ì˜¤ê¸°
          <input id="importFile" type="file" accept="application/json" style="display:none">
        </label>
        <button type="button" id="clearBtn" class="btn danger" style="display:none">ì „ì²´ ì‚­ì œ</button>
      </div>
      <div class="muted">â€» ë¡œê·¸ì¸ í›„ì—ë§Œ ì‘ì„± ê°€ëŠ¥. ì¼ë°˜ ì‚¬ìš©ìëŠ” ë³¸ì¸ ê¸€ë§Œ ì‚­ì œ ê°€ëŠ¥. ê´€ë¦¬ìëŠ” ëª¨ë“  ê¸°ëŠ¥/ê¸€ ê´€ë¦¬ ê°€ëŠ¥.</div>
    </form>
  </section>
  <div class="toolbar">
    <span class="badge"><span id="count">0</span> ê°œ ê¸€</span>
    <button type="button" id="sortBtn" class="btn sm">ìµœì‹ ìˆœ</button>
    <button type="button" id="copyLink" class="btn sm">í˜ì´ì§€ ë§í¬ ë³µì‚¬</button>
  </div>
  <section id="list" class="list" aria-live="polite">
    <div class="loading">ë°ì´í„° ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘...</div>
  </section>
  <footer>Firebase Firestore Â· ì‹¤ì‹œê°„ ë™ê¸°í™” Â· ëª¨ë“  ê¸°ê¸°ì—ì„œ ë™ì¼í•œ ë°ì´í„° ê³µìœ </footer>
</div>
<div id="modalRoot" class="modal-backdrop" role="dialog" aria-modal="true" aria-hidden="true">
  <div class="modal" role="document">
    <h3 id="modalTitle">ì•Œë¦¼</h3>
    <p id="modalMsg">ë©”ì‹œì§€</p>
    <div class="actions">
      <button id="modalCancel" class="btn">ì·¨ì†Œ</button>
      <button id="modalOk" class="btn primary">í™•ì¸</button>
    </div>
  </div>
</div>
<!-- Firebase SDK (compat ë²„ì „) -->
<script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>
<script>
// ========================================
// ğŸ”¥ Firebase ì„¤ì •
// ========================================
const firebaseConfig = {
  apiKey: "AIzaSyBpyN0WdmiKDb35Ws4zhhvxpJ7QgBwU8Eg",
  authDomain: "project-e965a.firebaseapp.com",
  projectId: "project-e965a",
  storageBucket: "project-e965a.firebasestorage.app",
  messagingSenderId: "272028274639",
  appId: "1:272028274639:web:a6e14e87cf6f44285b0cba",
  measurementId: "G-KGQ4FSCF6V"
};

// Firebase ì´ˆê¸°í™”
firebase.initializeApp(firebaseConfig);
const db = firebase.firestore();
const postsRef = db.collection('posts');

// ========================================
// í† ìŠ¤íŠ¸ ì•Œë¦¼
// ========================================
function showToast(msg, ms=2000){
  let t = document.querySelector('.toast');
  if (!t) {
    t = document.createElement('div');
    t.className = 'toast';
    document.body.appendChild(t);
  }
  t.textContent = msg;
  requestAnimationFrame(() => t.classList.add('show'));
  clearTimeout(t._timer);
  t._timer = setTimeout(() => t.classList.remove('show'), ms);
}

// ========================================
// ë©”ì¸ ë¡œì§
// ========================================
(() => {
  const $  = s => document.querySelector(s);
  const $$ = s => Array.from(document.querySelectorAll(s));
  const tz = 'Asia/Seoul';
  let posts = [];
  let newestFirst = true;

  const USERS = {
    'ë‚˜ì˜': '000525',
    'í˜„í˜¸ìŒ¤': '000000',
    'í˜œë¹ˆìŒ¤': '000000',
  };
  const ADMIN = { name: 'ê´€ë¦¬ì', password: 'ê¹€ìŠ¹ìš°' };

  let authed = null;

  const errBox = $('#err');
  const showError = (m) => { errBox.textContent = m; errBox.style.display = m ? 'block' : 'none'; };
  const escapeHTML = (s='') => s.replace(/[&<>"']/g, c => ({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'}[c]));
  const fmtTime = (ms) => new Intl.DateTimeFormat('ko-KR',{year:'numeric',month:'2-digit',day:'2-digit',hour:'2-digit',minute:'2-digit',hour12:false,timeZone:tz}).format(new Date(ms));
  const relTime = (ms) => { const sec=Math.floor((Date.now()-ms)/1000); if(sec<60)return `${sec}ì´ˆ ì „`; const m=Math.floor(sec/60); if(m<60)return `${m}ë¶„ ì „`; const h=Math.floor(m/60); if(h<24)return `${h}ì‹œê°„ ì „`; const d=Math.floor(h/24); return `${d}ì¼ ì „`; };

  // ========================================
  // Firebase ì‹¤ì‹œê°„ ë¦¬ìŠ¤ë„ˆ
  // ========================================
  postsRef.orderBy('ts', 'desc').onSnapshot(snapshot => {
    posts = [];
    snapshot.forEach(doc => {
      posts.push({ id: doc.id, ...doc.data() });
    });
    render();
  }, err => {
    console.error('Firebase ì—ëŸ¬:', err);
    showError('ë°ì´í„°ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤.');
  });

  // ========================================
  // UI ê¶Œí•œ ì„¤ì •
  // ========================================
  function setUIAuth(state){
    authed = state;
    const nameInput  = $('#name');
    const msgInput   = $('#msg');
    const submitBtn  = $('#submitBtn');
    const statusEl   = $('#status');
    const logoutBtn  = $('#logoutBtn');
    const exportBtn  = $('#exportBtn');
    const importLbl  = $('#importLabel');
    const clearBtn   = $('#clearBtn');

    if (authed){
      nameInput.value = authed.name;
      msgInput.disabled = false;
      submitBtn.disabled = false;
      statusEl.textContent = (authed.role === 'admin') ? `ê´€ë¦¬ì ë¡œê·¸ì¸` : `ë¡œê·¸ì¸: ${authed.name}`;
      logoutBtn.style.display = '';

      const isAdmin = authed.role === 'admin';
      exportBtn.style.display = isAdmin ? '' : 'none';
      importLbl.style.display = isAdmin ? '' : 'none';
      clearBtn.style.display  = isAdmin ? '' : 'none';
    }else{
      nameInput.value = '';
      msgInput.disabled = true;
      submitBtn.disabled = true;
      statusEl.textContent = 'ë¡œê·¸ì¸ ì•ˆ ë¨';
      logoutBtn.style.display = 'none';
      exportBtn.style.display = 'none';
      importLbl.style.display = 'none';
      clearBtn.style.display  = 'none';
    }
    nameInput.disabled = true;
    render();
  }

  // ========================================
  // ë¡œê·¸ì¸
  // ========================================
  function loginAsUser(who){
    const pw = prompt(`${who} ë¹„ë°€ë²ˆí˜¸ ì…ë ¥`);
    if (pw == null) return;
    if (USERS[who] && USERS[who] === pw.trim()){
      setUIAuth({name: who, role: 'user'});
    }else{
      modalAlert('ë¹„ë°€ë²ˆí˜¸ê°€ ì˜¬ë°”ë¥´ì§€ ì•ŠìŠµë‹ˆë‹¤.', 'ì•Œë¦¼');
    }
  }
  function loginAsAdmin(){
    const pw = prompt(`ê´€ë¦¬ì ë¹„ë°€ë²ˆí˜¸ ì…ë ¥`);
    if (pw == null) return;
    if (pw.trim() === ADMIN.password){
      setUIAuth({name: ADMIN.name, role: 'admin'});
    }else{
      modalAlert('ë¹„ë°€ë²ˆí˜¸ê°€ ì˜¬ë°”ë¥´ì§€ ì•ŠìŠµë‹ˆë‹¤.', 'ì•Œë¦¼');
    }
  }

  $$('.btn.sm[data-user]').forEach(btn => btn.addEventListener('click', () => loginAsUser(btn.dataset.user)));
  $('[data-admin="true"]').addEventListener('click', loginAsAdmin);
  $('#logoutBtn').addEventListener('click', () => setUIAuth(null));

  // ========================================
  // ë Œë”ë§
  // ========================================
  function render(){
    const list = $('#list');
    list.innerHTML = '';
    const arr = posts.slice().sort((a,b)=> newestFirst ? b.ts - a.ts : a.ts - b.ts);
    $('#count').textContent = String(arr.length);
    const isAdmin = authed && authed.role === 'admin';

    if (arr.length === 0) {
      list.innerHTML = '<div class="loading">ì•„ì§ ì‘ì„±ëœ ê¸€ì´ ì—†ìŠµë‹ˆë‹¤.</div>';
      return;
    }

    for (const p of arr) {
      const card = document.createElement('article'); card.className = 'post';
      const meta = document.createElement('div'); meta.className='meta';

      const left = document.createElement('div');
      const name = document.createElement('span'); name.className='name'; name.textContent = p.author || '(ìµëª…)';
      const time = document.createElement('span'); time.className='time'; time.textContent = `${fmtTime(p.ts)} Â· ${relTime(p.ts)}`;
      left.append(name, document.createTextNode(' Â· '), time);

      const right = document.createElement('div');
      const canDelete = isAdmin || (authed && authed.role==='user' && authed.name === p.author);
      if (canDelete){
        const delBtn = document.createElement('button'); 
        delBtn.className='btn danger sm'; 
        delBtn.textContent='ì‚­ì œ';
        delBtn.addEventListener('click', async() => {
          if (!(await modalConfirm('ì •ë§ ì‚­ì œí• ê¹Œìš”?', 'ì‚­ì œ í™•ì¸', 'ì‚­ì œ', 'ì·¨ì†Œ'))) return;
          try {
            await postsRef.doc(p.id).delete();
            showToast('ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.');
          } catch (err) {
            showError('ì‚­ì œ ì‹¤íŒ¨: ' + err.message);
          }
        });
        right.appendChild(delBtn);
      }

      meta.append(left, right);

      const msg = document.createElement('div'); msg.className='msg';
      msg.innerHTML = escapeHTML(p.msg).replace(/\n/g,'<br>');

      card.append(meta, msg);
      list.appendChild(card);
    }
  }

  // ========================================
  // ì´ˆê¸°í™”
  // ========================================
  setUIAuth(null);

  // ========================================
  // ê¸€ ì‘ì„±
  // ========================================
  $('#form').addEventListener('submit', async (e) => {
    e.preventDefault();
    showError('');
    if (!authed){ showError('ë¡œê·¸ì¸ í›„ ì‘ì„±í•  ìˆ˜ ìˆì–´ìš”.'); return; }
    const msg = $('#msg').value.trim();
    if (!msg){ showError('ë©”ì‹œì§€ëŠ” í•„ìˆ˜ì˜ˆìš”.'); return; }

    const submitBtn = $('#submitBtn');
    submitBtn.disabled = true;
    submitBtn.textContent = 'ì „ì†¡ ì¤‘...';

    try {
      await postsRef.add({
        author: authed.name,
        msg: msg.slice(0,100),
        ts: Date.now()
      });
      showToast('í‡´ê·¼ í›„ í™•ì¸í•˜ì—¬ ì²˜ë¦¬í•´ë“œë¦¬ê² ìŠµë‹ˆë‹¤.', 2000);
      $('#msg').value = '';
    } catch (err) {
      showError('ì‘ì„± ì‹¤íŒ¨: ' + err.message);
    } finally {
      submitBtn.disabled = false;
      submitBtn.textContent = 'ì‘ì„±í•˜ê¸°';
    }
  });

  // ========================================
  // ì •ë ¬ í† ê¸€
  // ========================================
  $('#sortBtn').addEventListener('click', () => {
    newestFirst = !newestFirst;
    $('#sortBtn').textContent = newestFirst ? 'ìµœì‹ ìˆœ' : 'ì˜¤ë˜ëœìˆœ';
    render();
  });

  // ========================================
  // ê´€ë¦¬ì: ì „ì²´ ì‚­ì œ
  // ========================================
  $('#clearBtn').addEventListener('click', async () => {
    if (!(authed && authed.role==='admin')) { await modalAlert('ê´€ë¦¬ìë§Œ ê°€ëŠ¥í•©ë‹ˆë‹¤.', 'ì•Œë¦¼'); return; }
    if (posts.length === 0) { await modalAlert('ì‚­ì œí•  ê¸€ì´ ì—†ìŠµë‹ˆë‹¤.', 'ì•Œë¦¼'); return; }
    if (!(await modalConfirm('ì •ë§ ì „ì²´ ì‚­ì œí• ê¹Œìš”?', 'ì „ì²´ ì‚­ì œ', 'ì‚­ì œ', 'ì·¨ì†Œ'))) return;
    
    try {
      const batch = db.batch();
      posts.forEach(p => batch.delete(postsRef.doc(p.id)));
      await batch.commit();
      showToast('ì „ì²´ ì‚­ì œë˜ì—ˆìŠµë‹ˆë‹¤.');
    } catch (err) {
      showError('ì‚­ì œ ì‹¤íŒ¨: ' + err.message);
    }
  });

  // ========================================
  // ê´€ë¦¬ì: JSON ë‚´ë³´ë‚´ê¸°
  // ========================================
  $('#exportBtn').addEventListener('click', async () => {
    if (!(authed && authed.role==='admin')) { await modalAlert('ê´€ë¦¬ìë§Œ ê°€ëŠ¥í•©ë‹ˆë‹¤.', 'ì•Œë¦¼'); return; }
    const blob = new Blob([JSON.stringify(posts, null, 2)], {type:'application/json'});
    const url = URL.createObjectURL(blob);
    const a = document.createElement('a');
    a.href = url; a.download = `guestbook-${new Date().toISOString().slice(0,10)}.json`;
    document.body.appendChild(a); a.click(); a.remove();
    URL.revokeObjectURL(url);
    showToast('ë‚´ë³´ë‚´ê¸° ì™„ë£Œ');
  });

  // ========================================
  // ê´€ë¦¬ì: JSON ê°€ì ¸ì˜¤ê¸°
  // ========================================
  $('#importFile').addEventListener('change', async (ev) => {
    if (!(authed && authed.role==='admin')) { await modalAlert('ê´€ë¦¬ìë§Œ ê°€ëŠ¥í•©ë‹ˆë‹¤.', 'ì•Œë¦¼'); ev.target.value=''; return; }
    const f = ev.target.files?.[0];
    if (!f) return;
    try {
      const text = await f.text();
      const data = JSON.parse(text);
      if (!Array.isArray(data)) throw new Error('ìµœìƒìœ„ ë°°ì—´ ì•„ë‹˜');
      
      const batch = db.batch();
      data.forEach(item => {
        const cleaned = {
          author: String(item.author || 'ìµëª…').slice(0,40),
          msg: String(item.msg || '').slice(0,100),
          ts: Number(item.ts || Date.now()),
        };
        if (cleaned.msg) {
          const newDocRef = postsRef.doc();
          batch.set(newDocRef, cleaned);
        }
      });
      await batch.commit();
      showToast('ê°€ì ¸ì˜¤ê¸° ì™„ë£Œ');
      ev.target.value = '';
    } catch (e) {
      showError('ê°€ì ¸ì˜¤ê¸° ì‹¤íŒ¨: ' + (e?.message || e));
    }
  });

  // ========================================
  // ë§í¬ ë³µì‚¬
  // ========================================
  $('#copyLink').addEventListener('click', async () => {
    try { 
      await navigator.clipboard.writeText(location.href); 
      await modalAlert('ë§í¬ë¥¼ ë³µì‚¬í–ˆìŠµë‹ˆë‹¤.', 'ì•Œë¦¼'); 
    } catch { 
      await modalAlert('ë³µì‚¬ ì‹¤íŒ¨. ìˆ˜ë™ìœ¼ë¡œ ì£¼ì†Œì°½ì„ ë³µì‚¬í•˜ì„¸ìš”.', 'ì•Œë¦¼'); 
    }
  });
})();

// ========================================
// ëª¨ë‹¬
// ========================================
function modalAlert(message, title='ì•Œë¦¼', okText='í™•ì¸'){
  return new Promise(resolve=>{
    const root = document.getElementById('modalRoot');
    const titleEl = document.getElementById('modalTitle');
    const msgEl = document.getElementById('modalMsg');
    const ok = document.getElementById('modalOk');
    const cancel = document.getElementById('modalCancel');

    titleEl.textContent = title;
    msgEl.textContent = message;
    cancel.style.display = 'none';
    ok.textContent = okText;

    const close = () => { 
      root.style.display='none'; 
      root.setAttribute('aria-hidden','true'); 
      ok.removeEventListener('click', onOk); 
      document.removeEventListener('keydown', onKey); 
    };
    const onOk = () => { close(); resolve(); };
    const onKey = (e)=>{ 
      if(e.key==='Escape'){ close(); resolve(); } 
      if(e.key==='Enter'){ onOk(); } 
    };

    ok.addEventListener('click', onOk);
    document.addEventListener('keydown', onKey);

    root.style.display='flex';
    root.setAttribute('aria-hidden','false');
    ok.focus();
  });
}

function modalConfirm(message, title='í™•ì¸', okText='í™•ì¸', cancelText='ì·¨ì†Œ'){
  return new Promise(resolve=>{
    const root = document.getElementById('modalRoot');
    const titleEl = document.getElementById('modalTitle');
    const msgEl = document.getElementById('modalMsg');
    const ok = document.getElementById('modalOk');
    const cancel = document.getElementById('modalCancel');

    titleEl.textContent = title;
    msgEl.textContent = message;
    cancel.style.display = '';
    ok.textContent = okText;
    cancel.textContent = cancelText;

    const close = () => {
      root.style.display='none'; 
      root.setAttribute('aria-hidden','true');
      ok.removeEventListener('click', onOk);
      cancel.removeEventListener('click', onCancel);
      document.removeEventListener('keydown', onKey);
    };
    const onOk = () => { close(); resolve(true);  };
    const onCancel = () => { close(); resolve(false); };
    const onKey = (e)=>{ 
      if(e.key==='Escape'){ onCancel(); } 
      if(e.key==='Enter'){ onOk(); } 
    };

    ok.addEventListener('click', onOk);
    cancel.addEventListener('click', onCancel);
    document.addEventListener('keydown', onKey);

    root.style.display='flex';
    root.setAttribute('aria-hidden','false');
    ok.focus();
  });
}
</script>
</body>
</html>
</artifact>